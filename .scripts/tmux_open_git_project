#!/bin/bash
# vim: set filetype=sh:

# Define the repos directory
repos_path="/path/to/your/repos" # replace with your actual repos path

# Function to run fzf in a tmux popup and get the selected path
select_git_repo() {
	tmux popup -E -K "find '$repos_path' -type d -name .git | sed 's|/\.git||' | fzf"
}

# Open fzf in a tmux popup to select a git repository
selected_repo=$(select_git_repo)

# If a repo was selected
if [ -n "$selected_repo" ]; then
	# Start a new tmux session with the name of the chosen repo
	session_name=$(basename "$selected_repo")
	tmux new-session -d -s "$session_name" -c "$selected_repo"

	# Send the nvim command to the new session
	tmux send-keys -t "$session_name" "nvim ." Enter

	# Attach to the new session
	tmux attach-session -t "$session_name"
else
	echo "No repository selected."
fi
